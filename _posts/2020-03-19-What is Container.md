---
layout: post
title:  "Container(컨테이너)란"
date:   2020-03-19T12:51:00
author: Taemy
categories: Kubernetes
tags: Container, Kubernetes
---

 Docker가 2015년 리눅스 재단에 Contribution 된 이후 많은 개발자들의 노력 끝에 이제는 컨테이너를 빼놓고는 컴퓨팅 환경을 논하기 힘들 정도가 되었습니다. 하지만 아직 컨테이너가 무엇인지, 왜 사람들이 열광하는지, 장점과 단점은 무엇인지 잘 모르는 사람들이 많습니다. 이번 포스트에서는 컨테이너가 열광받는 이유를 다뤄보고자 합니다.



## 가상 머신(Virtual Machine)

 가상 머신은 이미 많이 사용되었던 개념이라 익숙하시겠지만 Container를 논하기 전에 먼저 가상머신에 대해서 얘기해볼 필요가 있을 것 같습니다.  가상 머신은 Host PC의 운영체제 위에 하드웨어를 에뮬레이션해서 가상의 컴퓨팅 머신을 만들어 주는 것을 말합니다. 윈도우 pc상에서 쓰려고 Virtual Box같은 것을 써보신 분들은 금방 이해가 가실 겁니다. 일정량의 자원(cpu, 메모리나 하드웨어 용량 같은 것들)을 가상 머신에게 할당하면 컴퓨터가 동작하는 거랑 별개로 완전히 새로운 PC가 하나 더 동작하는 것처럼 보입니다. 그렇기 때문에 가상 머신을 커널 레벨 가상화라고 말하기도 합니다.

 가상머신에서는 리눅스의 커널부터 바이너리 라이브러리도 완전히 새로 설치하고 그 위에서 원하는 프로그램들을 동작시킬 수 있었습니다.

 실제로 이것은 하이퍼바이저라는 논리적인 층(Layer)가 존재해서 가상머신이 원하는 만큼의 자원을 할당받을 수 있도록 도와주는 것이었습니다.

 가상 머신의 등장으로 한 대의 성능좋은 컴퓨터를 잘 분할해서 여러 대의 컴퓨터가 있는 것처럼 보이도록 만들어 줄 수 있게 됐습니다. 기존에는 컴퓨터를 쓸 때 가용성이나 성능을 고려해서 여러 대의 컴퓨터를 구매하고 각각의 프로그램을 돌리고 하나하나 관리해줄 필요가 있었습니다. 때문에 가상 머신의 존재는 일반 PC를 사용하는 사람들 입장에서는 큰 차이가 없을 수도 있었지만, 회사나 서버를 관리해야 하는 관리자 입장에서는 큰 차이가 있었습니다. 비용이나 관리해야 할 서버 자체가 줄게 되었으니까요(물론 실제론 마냥 그렇진 않겠지만 :D... ).



모든 상황에 가상 머신이 필요할까?

그러나 여기서 생각해볼 문제가 있습니다.  가상 머신을 올린다는 건 좋은 아이디어지만, 가상 머신을 구성하기 위해서는 그 구성을 위해 커널로 올려줘야하고, 위에 운영체제도 올려야줘야 하고, 불필요한 라이브러리도 올라가게 됨과 동시에 그 과정에서 불필요한 자원들이 들어가게 됩니다. 

만약 서버에서 동작하던 프로그램이 작고 하나 정도만 돌아간다고 해도 굳이 그 자원들이 다 필요할까요? 이러한 의문에서 시작된 것이 컨테이너(Container) 입니다.



## Container란?

 ![img](http://img.scoop.it/tImVj_1Pbqv0HJDyMWTmBbnTzqrqzN7Y9aBZTaXoQ8Q=) 

Container에 대해서 이런 저런 검색을 많이 하신 분이라면 이미 아시겠지만 이론 상의 Container와 실제 구현되는 Container는 조오금 다릅니다.



 이론적으로 Container는 Host PC의 커널을 공유하면서 Host PC의 컴퓨팅 자원을 지정한 만큼 사용할 수 있도록 할당받고 자기가 사용할 수 있는 자원들을 볼 수 있도록 제한을 받는, 즉 격리된 공간에서 실행되는 프로세스를 말합니다. 

![Image result for 컨테이너](https://upload.wikimedia.org/wikipedia/commons/d/df/Container_01_KMJ.jpg) 

 좀 더 쉽게 이해하기 위해 이름인 Container부터 잘 생각해봅시다. Container는 사진에서 보는  것과 같이 물건을 넣을 수 있는 별도의 공간을 내부에 가집니다. 그리고 외부에서 쉽게 안을 볼 수 없도록 벽으로 격리되어 있죠. Container 안의 내용물을 프로세스라고 한다면 이론적인 Container의 개념과 일맥상통합니다.

 

이런 개념들이 나오기 시작한 것은 최근이 아닙니다. 이미 예전에도 Container라는 개념자체를 구현하기 위해서 여러 OS들이 현재의 컨테이너와 비슷한 lxc 같은 것을 내긴 했습니다. 2005년에선 process conatiner라는 커널모듈이 생기면서 이 격리된 환경을 구성하기 쉽게 만들어주었습니다. 차후에 이 process container의 이름은 cgroup으로 변경되었습니다. 여기에 우리가 알고있는 namespace 의 개념이 더해져 container를 이루게 되는 것입니다. 

 즉, Container는 cgroup 과 namespace의 조합으로 만들어지는 격리된 공간에서 프로세스를 실행시키는 기술이 되는 것입니다.



그러나 실제의 Container는 Host PC의 자원을 공유하고 그 위에 필요한 라이브러리 및 바이너리만을 올려서 프로그램을 동작시키는 것을 말합니다.



 좀 더 리눅스 관점에서 직관적으로 말씀드리면 Host PC위에 ls ps 같은 바이너리 중 필요한 것 일부 및 라이브러리들과 프로그램만 새로 올려서 생성되는 것이 Container가 되는 것입니다.